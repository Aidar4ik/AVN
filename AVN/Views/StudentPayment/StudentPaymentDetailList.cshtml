@model IEnumerable<StudentPaymentDetailVM>

<div class="row">
    <div class="col-md-6">
        <div id="dataContainer"></div>
    </div>
    <div class="col-md-6">
        <table class="table table-bordered" id="paymentDetailsTable">
            <thead class="thead-dark">
                <tr>
                    <th>@Html.DisplayNameFor(model => model.PaymentDate)</th>
                    <th>@Html.DisplayNameFor(model => model.Payment)</th>
                    <th>@Html.DisplayNameFor(model => model.Number)</th>
                    <th>@Html.DisplayNameFor(model => model.PaymentType)</th>
                    <th>@Html.DisplayNameFor(model => model.StudentPaymentId)</th>
                </tr>
            </thead>
            <tbody>
                @if (Model.Count() == 0)
                {
                    <tr>
                        <td colspan="5" class="text-center">Нет данных об оплатах</td>
                    </tr>
                }
                else
                {
                    @foreach (var group in Model.GroupBy(item => item.StudentPayment.Student))
                    {
                        <tr class="table-primary text-left">
                            <th colspan="8">@group.Key.SName @group.Key.Name @group.Key.PName</th>
                        </tr>
                    }
                    @foreach (var item in Model.OrderBy(item => item.PaymentDate))
                    {
                        <tr data-id="@item.Id">
                            <td>@(string.IsNullOrEmpty(item?.PaymentDate.ToString()) ? "-" : item.PaymentDate)</td>
                            <td>@(string.IsNullOrEmpty(item?.Payment.ToString()) ? "-" : item.Payment)</td>
                            <td>@item?.Number</td>
                            <td>@(string.IsNullOrEmpty(item?.PaymentType.ToString()) ? "-" : item?.PaymentType?.GetDisplayName())</td>
                            <td>@item?.StudentPayment?.AcademicYear?.Name</td>
                        </tr>
                    }
                }
            </tbody>
        </table>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            $('#paymentDetailsTable').on('click', 'tr', function () {
                var id = $(this).data('id');
                alert('hi');
                refreshPaymentDetailContainer(id);
            });
        });

        function refreshPaymentDetailContainer(id) {
            $.ajax({
                url: '@Url.Action("StudentPaymentDetails", "StudentPayment")',
                type: 'POST',
                data: {
                    id: id
                },
                success: function (data) {
                    $('#dataContainer').html(data);
                },
                error: function () {
                }
            });
        }
    </script>
}